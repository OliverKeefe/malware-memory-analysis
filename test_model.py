import tensorflow as tf
import pandas as pd
from keras.models import load_model

def load_test_data(data_path):
    df = pd.read_csv(data_path, sep=',',header=None)
    return df

def predict(model, new_data):
    predictions = model.predict(new_data)
    predicted_class = (predictions > 0.5).astype("int32")
    return predicted_class

def main():
    model = load_model('obfuscated_malware_memory_classifier.h5')
    new_data = load_test_data('test_data.csv')
    prediction = predict(model, new_data)
    print(prediction)
    if prediction > 0.5:
        print("f{test_data.csv} is malware")
    else:
        print("f{test_data.csv} is not malware")

if __name__ == "__main__":
    main()